brary(SOAR)
library(doMC)
doMC::registerDoMC(cores=8)

#load simulation results from Cesare
load('/mnt/sequencedb/PopGen/barbara/NCV_dir_package/simulations/clone_cee_sims/Results.all.ROC1.RData')
load('/mnt/sequencedb/PopGen/barbara/NCV_dir_package/simulations/clone_cee_sims/testf0.3/Results.all.ROC1_feq0.3.RData')
load('/mnt/sequencedb/PopGen/barbara/NCV_dir_package/simulations/clone_cee_sims/testf0.4/Results.all.ROC1_feq0.4_n100.RData')

pdf('ROCS_for_paper/Sept_ROC_all_stats_AFR_3000bp_Tbs5_feq0.5.pdf')

plot(x=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']]$ncvFD.ROC[,'FPR'],y=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']]$ncvFD[,'AFR_5s'],col='cornflowerblue', lwd=3, lty=1, xlim=c(0, 0.05), ylim=c(0,1), type='l', ylab="", xlab="", bty='l')
#lines(x=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']]$ncv.ROC[,'FPR'], y=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']]$ncv.ROC[,'AFR_5s'], lty=1, lwd=2, col='darkblue')
lines(x=TPR.T2.T1.AFR.Tbs5[[2]][,'FPR'], y=TPR.T2.T1.AFR.Tbs5[[2]][,'TPR.f0.5'], lwd=2, col='coral',lty=2)
#lines(x=TPR.T2.T1.AFR.Tbs5[[1]][,'FPR'], y=TPR.T2.T1.AFR.Tbs5[[1]][,'TPR.f0.5'], lwd=2, col='red4',lty=2)
lines(x=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']][['taj.ROC']][, 'FPR'], y= Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']][['taj.ROC']][, 'AFR_5s'], lwd=2, col='seagreen', lty=3)
lines(x=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']][['hka.ROC']][, 'FPR'], y= Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']][['hka.ROC']][, 'AFR_5s'], lwd=2, col='darkorchid4', lty=3)
legend('bottomright', c('NCD2','BETA','T2','TajD', 'HKA'),col=c('cornflowerblue','azure4','coral','seagreen','darkorchid4'), lty=c(1,2,2,3,3), lwd=c(4,2,2,2,2), bty='n',pch=c(19,19,19,19,19), xpd=F, horiz=F, cex=1.3)

lines(x=beta.Tbs5[['W_3kb']][['AFR']][, 'FPR'], y= beta.Tbs5[['W_3kb']][['AFR']][,'TPR.AFR.beta.f0.5'], col='azure4', lty=2, lwd=2)
#lines(x=Results.ROC.N100[["Tbs5"]][["bp3000"]][["fEq0.5"]][["ncv_hka.ROC"]][,'FPR.AFR_5s'], y=Results.ROC.N100[["Tbs5"]][["bp3000"]][["fEq0.5"]][["ncv_hka.ROC"]][,'AFR_5s'], col='steelblue', lty=2, lwd=2)
title(main="", sub="", xlab="FPR", ylab="TPR", cex.lab=1.5)
dev.off()
#EUR
pdf('ROCS_for_paper/Sept__ROC_all_stats_EUR_3000bp_Tbs5_feq0.5_v2.pdf')
plot(x=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']]$ncvFD[,'FPR'],y=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']]$ncvFD[,'EUR_5s'],col='cornflowerblue', lwd=3, lty=1, xlim=c(0, 0.05), ylim=c(0,1), type='l', ylab="", xlab="", bty='l')
#lines(x=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']]$ncv.ROC[,'FPR'], y=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']]$ncv.ROC[,'EUR_5s'], lty=1, lwd=2, col='darkblue')
lines(x=TPR.T2.T1.EUR.Tbs5[[2]][,'FPR'], y=TPR.T2.T1.EUR.Tbs5[[2]][,'TPR.f0.5'], lwd=2, col='coral',lty=2)
#lines(x=TPR.T2.T1.EUR.Tbs5[[1]][,'FPR'], y=TPR.T2.T1.EUR.Tbs5[[1]][,'TPR.f0.5'], lwd=2, col='red4',lty=2)
lines(x=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']][['taj.ROC']][, 'FPR'], y= Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']][['taj.ROC']][, 'EUR_5s'], lwd=2, col='seagreen', lty=3)
lines(x=Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']][['hka.ROC']][, 'FPR'], y= Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.5']][['hka.ROC']][, 'EUR_5s'], lwd=2, col='darkorchid4', lty=3)
legend('bottomright', c('NCD2','BETA','T2','TajD', 'HKA'),col=c('cornflowerblue','azure4','coral','seagreen','darkorchid4'), lty=c(1,2,2,3,3), lwd=c(4,2,2,2,2), bty='n',pch=c(19,19,19,19,19), xpd=F, horiz=F, cex=1.3)
lines(x=beta.Tbs5[['W_3kb']][['EUR']][, 'FPR'], y= beta.Tbs5[['W_3kb']][['EUR']][,'TPR.EUR.beta.f0.5'], col='azure4', lty=2, lwd=2)
#lines(x=Results.ROC.N100[["Tbs5"]][["bp3000"]][["fEq0.5"]][["ncv_hka.ROC"]][,'FPR.EUR_5s'], y=Results.ROC.N100[["Tbs5"]][["bp3000"]][["fEq0.5"]][["ncv_hka.ROC"]][,'EUR_5s'], col='steelblue', lty=2, lwd=2)
title(main="", sub="", xlab="FPR", ylab="TPR", cex.lab=1.5)
dev.off()

#tf0.4
pdf('ROCS_for_paper/Sept_ROC_all_stats_AFR_3000bp_Tbs5_feq0.4_ft0.4.pdf')
plot(x=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']]$ncvFD[,'FPR'],y=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']]$ncvFD[,'AFR_5s'],col='cornflowerblue', lwd=3, lty=1, xlim=c(0, 0.05), ylim=c(0,1), type='l', ylab="", xlab="", bty='l')
#lines(x=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']]$ncv.ROC[,'FPR'], y=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']]$ncv.ROC[,'AFR_5s'], lty=1, lwd=2, col='darkblue')
lines(x=TPR.T2.T1.AFR.Tbs5[[2]][,'FPR'], y=TPR.T2.T1.AFR.Tbs5[[2]][,'TPR.f0.4'], lwd=2, col='coral',lty=2)
#lines(x=TPR.T2.T1.AFR.Tbs5[[1]][,'FPR'], y=TPR.T2.T1.AFR.Tbs5[[1]][,'TPR.f0.4'], lwd=2, col='red4',lty=2)
lines(x=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']][['taj.ROC']][, 'FPR'], y= Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.4']][['taj.ROC']][, 'AFR_5s'], lwd=2, col='seagreen', lty=3)
lines(x=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']][['hka.ROC']][, 'FPR'], y= Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.4']][['hka.ROC']][, 'AFR_5s'], lwd=2, col='darkorchid4', lty=3)
legend('bottomright', c('NCD2','BETA','T2','TajD', 'HKA'),col=c('cornflowerblue','azure4','coral','seagreen','darkorchid4'), lty=c(1,2,2,3,3), lwd=c(4,2,2,2,2), bty='n',pch=c(19,19,19,19,19), xpd=F, horiz=F, cex=1.3)
lines(x=beta.Tbs5[['W_3kb']][['AFR']][, 'FPR'], y= beta.Tbs5[['W_3kb']][['AFR']][,'TPR.AFR.beta.f0.4'], col='azure4', lty=2, lwd=2)
#lines(x=Results.ROC.N_feq0.4_100[["Tbs5"]][["bp3000"]][["fEq0.4"]][["ncv_hka.ROC"]][,'FPR.AFR_5s'], y=Results.ROC.N_feq0.4_100[["Tbs5"]][["bp3000"]][["fEq0.4"]][["ncv_hka.ROC"]][,'AFR_5s'], col='steelblue', lty=2, lwd=2)
title(main="", sub="", xlab="FPR", ylab="TPR", cex.lab=1.5)
dev.off()
#
pdf('ROCS_for_paper/Sept_ROC_all_stats_EUR_3000bp_Tbs5_feq0.4_ft0.4.pdf')
plot(x=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']]$ncvFD[,'FPR'],y=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']]$ncvFD[,'EUR_5s'],col='cornflowerblue', lwd=3, lty=1, xlim=c(0, 0.05), ylim=c(0,1), type='l', ylab="", xlab="", bty='l')
#lines(x=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']]$ncv.ROC[,'FPR'], y=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']]$ncv.ROC[,'AFR_5s'], lty=1, lwd=2, col='darkblue')
lines(x=TPR.T2.T1.EUR.Tbs5[[2]][,'FPR'], y=TPR.T2.T1.EUR.Tbs5[[2]][,'TPR.f0.4'], lwd=2, col='coral',lty=2)
#lines(x=TPR.T2.T1.AFR.Tbs5[[1]][,'FPR'], y=TPR.T2.T1.AFR.Tbs5[[1]][,'TPR.f0.4'], lwd=2, col='red4',lty=2)
lines(x=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']][['taj.ROC']][, 'FPR'], y= Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.4']][['taj.ROC']][, 'EUR_5s'], lwd=2, col='seagreen', lty=3)
lines(x=Results.ROC.N_feq0.4_100[['Tbs5']][['bp3000']][['fEq0.4']][['hka.ROC']][, 'FPR'], y= Results.ROC.N100[['Tbs5']][['bp3000']][['fEq0.4']][['hka.ROC']][, 'EUR_5s'], lwd=2, col='darkorchid4', lty=3)
legend('bottomright', c('NCD2','BETA','T2','TajD', 'HKA'),col=c('cornflowerblue','azure4','coral','seagreen','darkorchid4'), lty=c(1,2,2,3,3), lwd=c(4,2,2,2,2), bty='n',pch=c(19,19,19,19,19), xpd=F, horiz=F, cex=1.3)
lines(x=beta.Tbs5[['W_3kb']][['EUR']][, 'FPR'], y= beta.Tbs5[['W_3kb']][['EUR']][,'TPR.EUR.beta.f0.4'], col='azure4', lty=2, lwd=2)
#lines(x=Results.ROC.N_feq0.4_100[["Tbs5"]][["bp3000"]][["fEq0.4"]][["ncv_hka.ROC"]][,'FPR.AFR_5s'], y=Results.ROC.N_feq0.4_100[["Tbs5"]][["bp3000"]][["fEq0.4"]][["ncv_hka.ROC"]][,'AFR_5s'], col='steelblue', lty=2, lwd=2)
title(main="", sub="", xlab="FPR", ylab="TPR", cex.lab=1.5)
dev.off()

#

pdf('ROCS_for_paper/Sept_ROC_all_stats_AFR_3000bp_Tbs5_feq0.3_ft0.3.pdf')
plot(x=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']]$ncvFD.ROC[,'FPR'],y=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']]$ncvFD[,'AFR_5s'],col='cornflowerblue', lwd=3, lty=1, xlim=c(0, 0.05), ylim=c(0,1), type='l', ylab="", xlab="", bty='l')
#lines(x=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']]$ncv.ROC[,'FPR'], y=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']]$ncv.ROC[,'AFR_5s'], lty=1, lwd=2, col='darkblue')
lines(x=TPR.T2.T1.AFR.Tbs5[[2]][,'FPR'], y=TPR.T2.T1.AFR.Tbs5[[2]][,'TPR.f0.3'], lwd=2, col='coral',lty=2)
#lines(x=TPR.T2.T1.AFR.Tbs5[[1]][,'FPR'], y=TPR.T2.T1.AFR.Tbs5[[1]][,'TPR.f0.3'], lwd=2, col='red4',lty=2)
lines(x=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']][['taj.ROC']][, 'FPR'], y= Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']][['taj.ROC']][, 'AFR_5s'], lwd=2, col='seagreen', lty=3)
lines(x=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']][['hka.ROC']][, 'FPR'], y= Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']][['hka.ROC']][, 'AFR_5s'], lwd=2, col='darkorchid4', lty=3)
legend('bottomright', c('NCD2','BETA','T2','TajD', 'HKA'),col=c('cornflowerblue','azure4','coral','seagreen','darkorchid4'), lty=c(1,2,2,3,3), lwd=c(4,2,2,2,2), bty='n',pch=c(19,19,19,19,19), xpd=F, horiz=F, cex=1.3)
lines(x=beta.Tbs5[['W_3kb']][['AFR']][, 'FPR'], y= beta.Tbs5[['W_3kb']][['AFR']][,'TPR.AFR.beta.f0.3'], col='azure4', lty=2, lwd=2)
#lines(x=Results.ROC.N_feq0.3_100[["Tbs5"]][["bp3000"]][["fEq0.3"]][["ncv_hka.ROC"]][,'FPR.AFR_5s'], y=Results.ROC.N_feq0.3_100[["Tbs5"]][["bp3000"]][["fEq0.3"]][["ncv_hka.ROC"]][,'AFR_5s'], col='steelblue', lty=2, lwd=2)
title(main="", sub="", xlab="FPR", ylab="TPR", cex.lab=1.5)
dev.off()

pdf('ROCS_for_paper/Sept_ROC_all_stats_EUR_3000bp_Tbs5_feq0.3_ft0.3.pdf')
plot(x=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']]$ncvFD.ROC[,'FPR'],y=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']]$ncvFD[,'EUR_5s'],col='cornflowerblue', lwd=3, lty=1, xlim=c(0, 0.05), ylim=c(0,1), type='l', ylab="", xlab="", bty='l')
#lines(x=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']]$ncv.ROC[,'FPR'], y=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']]$ncv.ROC[,'AFR_5s'], lty=1, lwd=2, col='darkblue')
lines(x=TPR.T2.T1.EUR.Tbs5[[2]][,'FPR'], y=TPR.T2.T1.EUR.Tbs5[[2]][,'TPR.f0.3'], lwd=2, col='coral',lty=2)
#lines(x=TPR.T2.T1.AFR.Tbs5[[1]][,'FPR'], y=TPR.T2.T1.AFR.Tbs5[[1]][,'TPR.f0.3'], lwd=2, col='red4',lty=2)
lines(x=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']][['taj.ROC']][, 'FPR'], y= Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']][['taj.ROC']][, 'EUR_5s'], lwd=2, col='seagreen', lty=3)
lines(x=Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']][['hka.ROC']][, 'FPR'], y= Results.ROC.N_feq0.3_100[['Tbs5']][['bp3000']][['fEq0.3']][['hka.ROC']][, 'EUR_5s'], lwd=2, col='darkorchid4', lty=3)
legend('bottomright', c('NCD2','BETA','T2','TajD', 'HKA'),col=c('cornflowerblue','azure4','coral','seagreen','darkorchid4'), lty=c(1,2,2,3,3), lwd=c(4,2,2,2,2), bty='n',pch=c(19,19,19,19,19), xpd=F, horiz=F, cex=1.3)
lines(x=beta.Tbs5[['W_3kb']][['EUR']][, 'FPR'], y= beta.Tbs5[['W_3kb']][['EUR']][,'TPR.EUR.beta.f0.3'], col='azure4', lty=2, lwd=2)
#lines(x=Results.ROC.N_feq0.3_100[["Tbs5"]][["bp3000"]][["fEq0.3"]][["ncv_hka.ROC"]][,'FPR.AFR_5s'], y=Results.ROC.N_feq0.3_100[["Tbs5"]][["bp3000"]][["fEq0.3"]][["ncv_hka.ROC"]][,'AFR_5s'], col='steelblue', lty=2, lwd=2)
title(main="", sub="", xlab="FPR", ylab="TPR", cex.lab=1.5)
dev.off()




